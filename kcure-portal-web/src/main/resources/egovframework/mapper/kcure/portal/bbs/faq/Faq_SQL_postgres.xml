<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Faq">
	<select id="selectFaqList" parameterType="kcure.portal.bbs.ntc.service.impl.NtcVO" resultType="egovMap">
		SELECT A.NTT_ID, A.BBS_ID, A.NTT_SE_CODE
			, A.NTT_SJ, A.NTT_CN, A.RDCNT
			, A.NTCE_BGNDE, A.NTCE_ENDDE, A.NTCR_ID
			, A.NTCR_NM, A.ATCH_FILE_ID, A.NOTICE_AT, A.USE_AT
		FROM PORTAL.KCURE_COM_COMTNBBS A
		WHERE A.BBS_ID = #{bbsId}
		AND A.USE_AT = 'Y'
		<if test="searchKeyword1 != null and searchKeyword1 !=''">
			AND A.NTT_SE_CODE = #{searchKeyword1}
		</if>
		<if test="searchKeyword != null and searchKeyword !=''">
			<if test="searchCondition == 0">
				AND (UPPER(A.NTT_SJ) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%') OR UPPER(A.NTT_CN) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%'))
	 		</if>
			<if test="searchCondition == 1">
	 			AND UPPER(A.NTT_SJ) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%')
	 		</if>
			<if test="searchCondition == 2">
	 			AND UPPER(A.NTT_CN) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%')
	 		</if>
		</if>
    	ORDER BY A.NTT_ID DESC
	</select>

	<select id="selectFaqListTotCnt" parameterType="kcure.portal.bbs.ntc.service.impl.NtcVO" resultType="java.lang.Integer">
		SELECT
			COUNT(1) AS totcnt
		FROM PORTAL.KCURE_COM_COMTNBBS A
		WHERE A.BBS_ID = #{bbsId}
		AND A.USE_AT = 'Y'
		<if test="searchKeyword1 != null and searchKeyword1 !=''">
			AND A.NTT_SE_CODE = #{searchKeyword1}
		</if>
		<if test="searchKeyword != null and searchKeyword !=''">
			<if test="searchCondition == 0">
				AND (UPPER(A.NTT_SJ) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%') OR UPPER(A.NTT_CN) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%'))
			</if>
			<if test="searchCondition == 1">
				AND UPPER(A.NTT_SJ) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%')
			</if>
			<if test="searchCondition == 2">
				AND UPPER(A.NTT_CN) LIKE CONCAT('%' , UPPER(#{searchKeyword}), '%')
			</if>
		</if>
	</select>
</mapper>